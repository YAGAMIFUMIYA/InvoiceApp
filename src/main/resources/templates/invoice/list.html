<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>請求書一覧</title>
</head>
<body>
<h2 class="mb-4">請求書一覧</h2>

<a th:href="@{/invoices/form}" class="btn btn-success mb-3">＋ 新規作成</a>

<table class="table table-striped table-bordered">
    <thead class="table-dark">
    <tr>
        <th>顧客ID</th>
        <th>発行日</th>
        <th>支払期日</th>
        <th>金額</th>
        <th>ステータス</th>
        <th>操作</th>
        <th>顧客情報</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="invoice : ${invoices}">
        <td th:text="${invoice.id}"></td>
        <td th:text="${invoice.issueDate}"></td>
        <td th:text="${invoice.dueDate}"></td>
        <td th:text="${invoice.amount}"></td>
        <td th:text="${invoice.status}"></td>
        <td>
            <a th:href="@{'/invoices/edit/' + ${invoice.id}}" class="btn btn-warning btn-sm">編集</a>
            <a th:href="@{'/invoices/delete/' + ${invoice.id}}" class="btn btn-danger btn-sm"
               onclick="return confirm('本当に削除しますか？');">削除</a>
        </td>
        <!-- ここに顧客ページへのリンクを追加（ループ内なので ${invoice} が解決される） -->
        <td>
            <a th:if="${invoice.customerId != null}"
               th:href="@{'/customers/edit/' + ${invoice.customerId}}"
               th:text="${'顧客ID: ' + invoice.customerId}">顧客</a>
            <span th:unless="${invoice.customerId != null}">未指定</span>
        </td>
    </tr>
    </tbody>
</table>

</body>
</html>